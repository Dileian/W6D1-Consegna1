#include <stdio.h>
#include <string.h>

#define NUMERO_DOMANDE 6
#define NUMERO_OPZIONI_DOMANDA 3

typedef struct {
    char domanda[256];
    char risposte[NUMERO_OPZIONI_DOMANDA][100]; // Array di stringhe per le risposte
    int RispostaCorretta;
} Domanda;

int PunteggioTotalePartita = 0;

void VisualizzaMenu();
void NuovaPartita();
int NuovaDomanda(Domanda q);
void MostraPunteggioFinale(int punteggio);
void MostraPunteggioTotale();
void ImpostaDomande(Domanda *domande);
void Introduzione();

void Introduzione() {
    printf("\nCiao! Questo è un quiz di cultura generale!\n");
    printf("Seleziona la risposta corretta e riceverai un punto se si rivelerà esatta.\n");
    printf("Dai forza! Mettiti alla prova! BUONA FORTUNA!\n");
}

void ImpostaDomande(Domanda *domande) {
    strcpy(domande[0].domanda, "Quale pianeta è conosciuto come il pianeta rosso?");
    strcpy(domande[0].risposte[0], "Giove");
    strcpy(domande[0].risposte[1], "Marte");
    strcpy(domande[0].risposte[2], "Venere");
    domande[0].RispostaCorretta = 2;

    strcpy(domande[1].domanda, "In quale città si trova la Torre Eiffel?");
    strcpy(domande[1].risposte[0], "Parigi");
    strcpy(domande[1].risposte[1], "Londra");
    strcpy(domande[1].risposte[2], "Madrid");
    domande[1].RispostaCorretta = 1;

    strcpy(domande[2].domanda, "Qual è il fiume più lungo d'Italia?");
    strcpy(domande[2].risposte[0], "Tevere");
    strcpy(domande[2].risposte[1], "Arno");
    strcpy(domande[2].risposte[2], "Po");
    domande[2].RispostaCorretta = 3;

    strcpy(domande[3].domanda, "Qual è il gas più abbondante nell'atmosfera terrestre?");
    strcpy(domande[3].risposte[0], "Ossigeno");
    strcpy(domande[3].risposte[1], "Azoto");
    strcpy(domande[3].risposte[2], "Anidride carbonica");
    domande[3].RispostaCorretta = 2;

    strcpy(domande[4].domanda, "Chi ha scritto 'I Promessi Sposi'?");
    strcpy(domande[4].risposte[0], "Alessandro Manzoni");
    strcpy(domande[4].risposte[1], "Francesco Petrarca");
    strcpy(domande[4].risposte[2], "Giacomo Leopardi");
    domande[4].RispostaCorretta = 1;

    strcpy(domande[5].domanda, "Quale organo è il principale nel sistema circolatorio umano?");
    strcpy(domande[5].risposte[0], "Polmoni");
    strcpy(domande[5].risposte[1], "Rene");
    strcpy(domande[5].risposte[2], "Cuore");
    domande[5].RispostaCorretta = 3;
}

void VisualizzaMenu() {
    char scelta;
    printf("Benvenuto!\n");
    do {
        printf("A) Nuova partita\nB) Esci\n");
        printf("Inserisci (A/B):");
        scelta = getchar();
        while (getchar() != '\n');

        switch (scelta) {
            case 'A':
            case 'a':
                NuovaPartita();
                break;
            case 'B':
            case 'b':
                printf("Grazie per esserti messo alla prova! A presto!\n");
                exit(0);
            default:
                printf("Non valido. Inserisci A o B.\n");
        }
    } while (scelta != 'a' && scelta != 'A' && scelta != 'b' && scelta != 'B');
}

void NuovaPartita() {
    Domanda domande[NUMERO_DOMANDE];
    ImpostaDomande(domande);
    int punteggio = 0;

    for (int i = 0; i < NUMERO_DOMANDE; i++) {
        punteggio += NuovaDomanda(domande[i]);
    }

    PunteggioTotalePartita += punteggio;
    MostraPunteggioFinale(punteggio);
    MostraPunteggioTotale();
}

int NuovaDomanda(Domanda q) {
    int RispostaUtente;

    printf("\n%s\n", q.domanda);
    for (int i = 0; i < NUMERO_OPZIONI_DOMANDA; i++) {
        printf("%d. %s\n", i + 1, q.risposte[i]);
    }
    printf("Digita il numero della risposta corretta:");
    scanf("%d", &RispostaUtente);
    while (getchar() != '\n');

    if (RispostaUtente == q.RispostaCorretta) {
        printf("Esatto!\n");
        return 1;
    } else {
        printf("Errato! La risposta corretta è %d. %s\n", q.RispostaCorretta, q.risposte[q.RispostaCorretta - 1]);
        return 0;
    }
}

void MostraPunteggioFinale(int punteggio) {
    printf("Eccoci! Il tuo punteggio finale è: %d su %d.\n", punteggio, NUMERO_DOMANDE);
}

void MostraPunteggioTotale() {
    printf("Fino ad ora hai totalizzato: %d punti.\n", PunteggioTotalePartita);
}

int main() {
    Introduzione();
    VisualizzaMenu();

    return 0;
}
